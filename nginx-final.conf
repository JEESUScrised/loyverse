server {
    listen 80;
    server_name jeesuscrised.ru www.jeesuscrised.ru;

    # Основное приложение
    location / {
        root /var/www/loyverse/app;
        try_files $uri $uri/ /index.html;
        index index.html;
    }

    # Статические файлы для основного приложения (должно быть ПЕРЕД общим правилом)
    location /assets/ {
        alias /var/www/loyverse/app/assets/;
        expires 1y;
        add_header Cache-Control "public, immutable";
        access_log off;
    }

    # Приложение владельца
    location /owner/ {
        alias /var/www/loyverse/owner/;
        try_files $uri $uri/ /owner/index.html;
        index index.html;
    }

    # Статические файлы для owner
    location /owner/assets/ {
        alias /var/www/loyverse/owner/assets/;
        expires 1y;
        add_header Cache-Control "public, immutable";
        access_log off;
    }

    # Приложение кассира
    location /cashier/ {
        alias /var/www/loyverse/cashier/;
        try_files $uri $uri/ /cashier/index.html;
        index index.html;
    }

    # Статические файлы для cashier
    location /cashier/assets/ {
        alias /var/www/loyverse/cashier/assets/;
        expires 1y;
        add_header Cache-Control "public, immutable";
        access_log off;
    }

    # Общие статические файлы (fallback для изображений и других файлов)
    location ~* \.(png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|map)$ {
        root /var/www/loyverse;
        expires 1y;
        add_header Cache-Control "public, immutable";
        access_log off;
    }
}
